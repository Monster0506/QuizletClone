<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quizlet Clone - Study Sets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#e0e7ff',
                            100: '#c7d2fe',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                        },
                        secondary: {
                            50: '#f3e8ff',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'mono': ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'bounce-gentle': 'bounceGentle 2s infinite',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        bounceGentle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 font-sans">
    <!-- Background Pattern -->
    <div class="fixed inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.05"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-20"></div>
    
    <div class="relative z-10 min-h-screen">
        <!-- Header -->
        <div class="text-center py-16 px-4">
            <div class="animate-fade-in">
                <h1 class="text-6xl md:text-7xl font-extrabold text-white mb-4 tracking-tight">
                    📚 Quizlet Clone
                </h1>
                <p class="text-xl md:text-2xl text-white/90 font-medium max-w-2xl mx-auto">
                    Create, study, and master your flashcard sets with beautiful, modern design
                </p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto px-4 pb-16">
            <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <!-- Header Section -->
                <div class="bg-gradient-to-r from-primary-500 to-secondary-500 px-8 py-6">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                        <div>
                            <h2 class="text-3xl font-bold text-white">Your Study Sets</h2>
                            <p class="text-white/80 mt-1">Organize and manage your learning materials</p>
                        </div>
                        <button 
                            onclick="createNewSet()" 
                            class="inline-flex items-center gap-2 bg-white text-primary-600 px-6 py-3 rounded-xl font-semibold hover:bg-white/90 hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl"
                        >
                            <span class="text-xl">+</span>
                            <span>Create New Set</span>
                        </button>
                    </div>
                </div>

                <!-- Sets Grid -->
                <div class="p-8">
                    <div id="sets-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Study sets will be displayed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Create New Set Modal -->
        <div id="create-set-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full animate-slide-up">
                <div class="bg-gradient-to-r from-primary-500 to-secondary-500 px-6 py-4 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold text-white">Create New Study Set</h3>
                        <button 
                            onclick="closeModal()" 
                            class="text-white/80 hover:text-white hover:bg-white/20 rounded-lg p-1 transition-colors"
                            aria-label="Close modal"
                        >
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="p-6 space-y-4">
                    <div>
                        <label for="set-name" class="block text-sm font-medium text-gray-700 mb-2">
                            Set Name
                        </label>
                        <input 
                            type="text" 
                            id="set-name" 
                            placeholder="Enter set name..." 
                            required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
                        >
                    </div>
                    <div>
                        <label for="set-description" class="block text-sm font-medium text-gray-700 mb-2">
                            Description (optional)
                        </label>
                        <input 
                            type="text" 
                            id="set-description" 
                            placeholder="Enter description..."
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
                        >
                    </div>
                </div>
                
                <div class="flex gap-3 p-6 pt-0">
                    <button 
                        onclick="closeModal()" 
                        class="flex-1 px-4 py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium transition-colors duration-200"
                    >
                        Cancel
                    </button>
                    <button 
                        onclick="saveNewSet()" 
                        class="flex-1 px-4 py-3 bg-gradient-to-r from-primary-500 to-secondary-500 text-white rounded-xl font-medium hover:from-primary-600 hover:to-secondary-600 transition-all duration-200 shadow-lg hover:shadow-xl"
                    >
                        Create Set
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="utils.js"></script>
    <script>
        // Global variables
        let studySets = [];
        let currentSetId = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadStudySets();
            renderStudySets();
        });

        // Study Set Management
        function loadStudySets() {
            const saved = localStorage.getItem('quizlet-study-sets');
            if (saved) {
                studySets = JSON.parse(saved);
            }
        }

        function saveStudySets() {
            localStorage.setItem('quizlet-study-sets', JSON.stringify(studySets));
        }

        function createNewSet() {
            const modal = document.getElementById('create-set-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.getElementById('set-name').focus();
        }

        function closeModal() {
            const modal = document.getElementById('create-set-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.getElementById('set-name').value = '';
            document.getElementById('set-description').value = '';
        }

        function saveNewSet() {
            const name = document.getElementById('set-name').value.trim();
            const description = document.getElementById('set-description').value.trim();

            if (name) {
                const newSet = {
                    id: Date.now(),
                    name: name,
                    description: description,
                    flashcards: [],
                    createdAt: new Date().toISOString(),
                    lastModified: new Date().toISOString()
                };

                studySets.push(newSet);
                saveStudySets();
                renderStudySets();
                closeModal();
            } else {
                alert('Please enter a set name');
            }
        }

        function deleteSet(setId) {
            if (confirm('Are you sure you want to delete this study set? This action cannot be undone.')) {
                studySets = studySets.filter(set => set.id !== setId);
                saveStudySets();
                renderStudySets();
            }
        }

        function renderStudySets() {
            const grid = document.getElementById('sets-grid');
            
            if (studySets.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full flex flex-col items-center justify-center py-16 text-center animate-fade-in">
                        <div class="text-8xl mb-6 animate-bounce-gentle">📚</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">No study sets yet</h3>
                        <p class="text-gray-600 mb-8 max-w-md">Create your first study set to get started with your learning journey!</p>
                        <button 
                            onclick="createNewSet()" 
                            class="inline-flex items-center gap-2 bg-gradient-to-r from-primary-500 to-secondary-500 text-white px-8 py-4 rounded-xl font-semibold hover:from-primary-600 hover:to-secondary-600 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105"
                        >
                            <span class="text-xl">+</span>
                            <span>Create Study Set</span>
                        </button>
                    </div>
                `;
                return;
            }

            grid.innerHTML = studySets.map((set, index) => `
                <div class="bg-white rounded-2xl shadow-lg hover:shadow-xl border border-gray-100 overflow-hidden transition-all duration-300 hover:-translate-y-1 animate-fade-in group" style="animation-delay: ${index * 100}ms">
                    <!-- Card Header -->
                    <div class="bg-gradient-to-r from-primary-50 to-secondary-50 px-6 py-4 border-b border-gray-100">
                        <div class="flex items-start justify-between">
                            <h3 class="text-xl font-bold text-gray-800 group-hover:text-primary-600 transition-colors duration-200 line-clamp-2">${escapeHtml(set.name)}</h3>
                            <button 
                                onclick="deleteSet(${set.id})" 
                                class="text-gray-400 hover:text-red-500 hover:bg-red-50 p-2 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100"
                                title="Delete set"
                            >
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Card Body -->
                    <div class="p-6">
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">${escapeHtml(set.description || 'No description')}</p>
                        
                        <!-- Stats -->
                        <div class="flex items-center gap-4 mb-6 text-sm text-gray-500">
                            <div class="flex items-center gap-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <span>${set.flashcards.length} cards</span>
                            </div>
                            <div class="flex items-center gap-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>${formatDate(set.lastModified)}</span>
                            </div>
                        </div>
                        
                        <!-- Game Links -->
                        <div class="grid grid-cols-2 gap-2 mb-6">
                            <a href="write.html?set=${set.id}" class="flex items-center justify-center gap-2 px-4 py-3 bg-gray-50 hover:bg-primary-50 text-gray-700 hover:text-primary-600 rounded-xl font-medium transition-all duration-200 hover:scale-105">
                                <span>✏️</span>
                                <span class="text-sm">Write</span>
                            </a>
                            <a href="match.html?set=${set.id}" class="flex items-center justify-center gap-2 px-4 py-3 bg-gray-50 hover:bg-secondary-50 text-gray-700 hover:text-secondary-600 rounded-xl font-medium transition-all duration-200 hover:scale-105">
                                <span>🎯</span>
                                <span class="text-sm">Match</span>
                            </a>
                            <a href="test.html?set=${set.id}" class="flex items-center justify-center gap-2 px-4 py-3 bg-gray-50 hover:bg-green-50 text-gray-700 hover:text-green-600 rounded-xl font-medium transition-all duration-200 hover:scale-105">
                                <span>📝</span>
                                <span class="text-sm">Test</span>
                            </a>
                            <a href="memory.html?set=${set.id}" class="flex items-center justify-center gap-2 px-4 py-3 bg-gray-50 hover:bg-purple-50 text-gray-700 hover:text-purple-600 rounded-xl font-medium transition-all duration-200 hover:scale-105">
                                <span>🧠</span>
                                <span class="text-sm">Memory</span>
                            </a>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex gap-2">
                            <button 
                                onclick="shareSet(${set.id})" 
                                class="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 hover:bg-primary-100 text-gray-700 hover:text-primary-600 rounded-lg font-medium transition-all duration-200 text-sm"
                                title="Share this set"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                </svg>
                                <span>Share</span>
                            </button>
                            <button 
                                onclick="exportSet(${set.id})" 
                                class="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 hover:bg-green-100 text-gray-700 hover:text-green-600 rounded-lg font-medium transition-all duration-200 text-sm"
                                title="Export as JSON"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <span>Export</span>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('create-set-modal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Fallback functions in case utils.js is not loaded
        function showNotification(message, type = 'info') {
            if (window.QuizletUtils && window.QuizletUtils.showNotification) {
                return window.QuizletUtils.showNotification(message, type);
            }
            
            // Create Tailwind notification
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 max-w-sm w-full bg-white rounded-xl shadow-lg border p-4 animate-slide-in-right`;
            
            const typeStyles = {
                success: 'border-green-200 bg-green-50',
                error: 'border-red-200 bg-red-50',
                warning: 'border-yellow-200 bg-yellow-50',
                info: 'border-blue-200 bg-blue-50'
            };
            
            const typeIcons = {
                success: '✅',
                error: '❌',
                warning: '⚠️',
                info: 'ℹ️'
            };
            
            notification.className += ` ${typeStyles[type] || typeStyles.info}`;
            
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <span class="text-xl">${typeIcons[type] || typeIcons.info}</span>
                    <span class="text-sm font-medium text-gray-800">${message}</span>
                    <button onclick="this.closest('.fixed').remove()" class="ml-auto text-gray-400 hover:text-gray-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        function escapeHtml(text) {
            if (window.QuizletUtils && window.QuizletUtils.escapeHtml) {
                return window.QuizletUtils.escapeHtml(text);
            }
            // Fallback HTML escaping
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Sharing functionality
        function shareSet(setId) {
            const studySet = studySets.find(set => set.id === setId);
            if (!studySet) {
                showNotification('Study set not found', 'error');
                return;
            }

            // Create shareable data
            const shareData = {
                name: studySet.name,
                description: studySet.description,
                flashcards: studySet.flashcards,
                version: '1.0',
                exportedAt: new Date().toISOString()
            };

            // Generate shareable URL
            const shareUrl = generateShareUrl(shareData);
            
            // Show share modal
            showShareModal(studySet, shareUrl, shareData);
        }

        function generateShareUrl(data) {
            // For now, we'll use a simple base64 encoding
            // In a real app, you'd upload to a server and get a short URL
            const encoded = btoa(JSON.stringify(data));
            return `${window.location.origin}${window.location.pathname}?import=${encoded}`;
        }

        function showShareModal(studySet, shareUrl, shareData) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50';
            
            // Store share data in the modal for later use
            modal.shareData = shareData;
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full animate-slide-up">
                    <div class="bg-gradient-to-r from-primary-500 to-secondary-500 px-6 py-4 rounded-t-2xl">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xl font-bold text-white">Share "${escapeHtml(studySet.name)}"</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white hover:bg-white/20 rounded-lg p-1 transition-colors">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6 space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Share Link</label>
                            <div class="flex gap-2">
                                <input type="text" id="share-url" value="${shareUrl}" readonly class="flex-1 px-4 py-3 border border-gray-300 rounded-xl bg-gray-50 text-sm font-mono">
                                <button onclick="copyShareUrl()" class="px-6 py-3 bg-gradient-to-r from-primary-500 to-secondary-500 text-white rounded-xl font-medium hover:from-primary-600 hover:to-secondary-600 transition-all duration-200 shadow-lg hover:shadow-xl">
                                    Copy
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">QR Code</label>
                            <div id="qr-code" class="text-center p-6 bg-gray-50 rounded-xl">
                                <div class="text-gray-500">Generating QR code...</div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-primary-50 to-secondary-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">Share Options</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="shareToClipboard()" class="flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-primary-50 text-gray-700 hover:text-primary-600 rounded-xl font-medium transition-all duration-200 border border-gray-200 hover:border-primary-200">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                    <span>Copy to Clipboard</span>
                                </button>
                                <button onclick="shareToEmail()" class="flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-blue-50 text-gray-700 hover:text-blue-600 rounded-xl font-medium transition-all duration-200 border border-gray-200 hover:border-blue-200">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                    </svg>
                                    <span>Email</span>
                                </button>
                                <button onclick="shareToSocial('twitter')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-blue-50 text-gray-700 hover:text-blue-600 rounded-xl font-medium transition-all duration-200 border border-gray-200 hover:border-blue-200">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                                    </svg>
                                    <span>Twitter</span>
                                </button>
                                <button onclick="shareToSocial('facebook')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-blue-50 text-gray-700 hover:text-blue-600 rounded-xl font-medium transition-all duration-200 border border-gray-200 hover:border-blue-200">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                    </svg>
                                    <span>Facebook</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 p-6 pt-0">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 px-4 py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium transition-colors duration-200">
                            Close
                        </button>
                        <button onclick="testImport()" class="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-medium transition-colors duration-200">
                            Test Import
                        </button>
                        <button onclick="exportSet(${studySet.id})" class="px-6 py-3 bg-gradient-to-r from-primary-500 to-secondary-500 text-white rounded-xl font-medium hover:from-primary-600 hover:to-secondary-600 transition-all duration-200 shadow-lg hover:shadow-xl">
                            Export JSON
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Generate QR code
            generateQRCode(shareUrl, document.getElementById('qr-code'));
            
            // Store share data in the modal for import functionality
            modal.importData = shareData;
        }

        function copyShareUrl() {
            const input = document.getElementById('share-url');
            input.select();
            input.setSelectionRange(0, 99999);
            document.execCommand('copy');
            showNotification('Link copied to clipboard!', 'success');
            
            // Store share data in the modal for import functionality
            const modal = input.closest('.modal');
            if (modal && modal.shareData) {
                modal.importData = modal.shareData;
            }
        }

        function testImport() {
            const modal = document.querySelector('.modal');
            if (modal && modal.importData) {
                showImportModal(modal.importData);
            } else {
                showNotification('No import data available', 'error');
            }
        }

        function shareToClipboard() {
            const shareUrl = document.getElementById('share-url').value;
            const studySet = studySets.find(set => set.id === parseInt(event.target.closest('.modal').querySelector('button[onclick*="exportSet"]').onclick.toString().match(/\d+/)[0]));
            
            const text = `Check out this study set: "${studySet.name}"\n\n${shareUrl}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('Copied to clipboard!', 'success');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Copied to clipboard!', 'success');
            }
        }

        function shareToEmail() {
            const shareUrl = document.getElementById('share-url').value;
            const studySet = studySets.find(set => set.id === parseInt(event.target.closest('.modal').querySelector('button[onclick*="exportSet"]').onclick.toString().match(/\d+/)[0]));
            
            const subject = `Check out this study set: ${studySet.name}`;
            const body = `I found this great study set and thought you might like it!\n\n${shareUrl}\n\nHappy studying!`;
            
            window.open(`mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);
        }

        function shareToSocial(platform) {
            const shareUrl = document.getElementById('share-url').value;
            const studySet = studySets.find(set => set.id === parseInt(event.target.closest('.modal').querySelector('button[onclick*="exportSet"]').onclick.toString().match(/\d+/)[0]));
            
            const text = `Check out this study set: "${studySet.name}"`;
            
            let url;
            switch (platform) {
                case 'twitter':
                    url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(shareUrl)}`;
                    break;
                case 'facebook':
                    url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(text)}`;
                    break;
            }
            
            if (url) {
                window.open(url, '_blank', 'width=600,height=400');
            }
        }

        function generateQRCode(text, container) {
            // Use a free QR code service
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(text)}`;
            
            
            container.innerHTML = `
                <img src="${qrUrl}" alt="QR Code" class="w-48 h-48 rounded-xl mx-auto block shadow-lg">
                <p class="text-center mt-3 text-sm text-gray-600 font-medium">
                    Scan to open study set
                </p>
            `;
            
            
            
            
        }

        function exportSet(setId) {
            const studySet = studySets.find(set => set.id === setId);
            if (!studySet) {
                QuizletUtils.showNotification('Study set not found', 'error');
                return;
            }

            const exportData = {
                name: studySet.name,
                description: studySet.description,
                flashcards: studySet.flashcards,
                version: '1.0',
                exportedAt: new Date().toISOString(),
                exportedBy: 'Quizlet Clone'
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `${studySet.name.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.json`;
            link.click();
            
            showNotification('Study set exported!', 'success');
        }

        // Import functionality
        function checkForImport() {
            const urlParams = new URLSearchParams(window.location.search);
            const importData = urlParams.get('import');
            
            console.log('Checking for import data:', importData);
            
            if (importData) {
                try {
                    const data = JSON.parse(atob(importData));
                    console.log('Parsed import data:', data);
                    showImportModal(data);
                } catch (e) {
                    console.error('Error parsing import data:', e);
                    showNotification('Invalid import data', 'error');
                }
            }
        }

        function showImportModal(data) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50';
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full animate-slide-up">
                    <div class="bg-gradient-to-r from-primary-500 to-secondary-500 px-6 py-4 rounded-t-2xl">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xl font-bold text-white">Import Study Set</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white hover:bg-white/20 rounded-lg p-1 transition-colors">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div class="bg-gradient-to-r from-primary-50 to-secondary-50 p-4 rounded-xl">
                            <h4 class="text-lg font-semibold text-primary-700 mb-3">Study Set Details</h4>
                            <div class="space-y-2 text-sm">
                                <p><span class="font-medium text-gray-700">Name:</span> <span class="text-gray-600">${escapeHtml(data.name)}</span></p>
                                <p><span class="font-medium text-gray-700">Description:</span> <span class="text-gray-600">${escapeHtml(data.description || 'No description')}</span></p>
                                <p><span class="font-medium text-gray-700">Cards:</span> <span class="text-gray-600">${data.flashcards.length}</span></p>
                                <p><span class="font-medium text-gray-700">Exported:</span> <span class="text-gray-600">${new Date(data.exportedAt).toLocaleDateString()}</span></p>
                            </div>
                        </div>
                        
                        <div>
                            <label for="import-name" class="block text-sm font-medium text-gray-700 mb-2">Set Name</label>
                            <input type="text" id="import-name" value="${escapeHtml(data.name)}" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="import-description" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <input type="text" id="import-description" value="${escapeHtml(data.description || '')}" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200">
                        </div>
                    </div>
                    
                    <div class="flex gap-3 p-6 pt-0">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 px-4 py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium transition-colors duration-200">
                            Cancel
                        </button>
                        <button onclick="importStudySet()" class="flex-1 px-4 py-3 bg-gradient-to-r from-primary-500 to-secondary-500 text-white rounded-xl font-medium hover:from-primary-600 hover:to-secondary-600 transition-all duration-200 shadow-lg hover:shadow-xl">
                            Import Set
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Store import data
            modal.importData = data;
        }

        function importStudySet() {
            // Find the import modal specifically (the one with import data)
            const modals = document.querySelectorAll('.fixed');
            let modal = null;
            for (let m of modals) {
                if (m.importData) {
                    modal = m;
                    break;
                }
            }
            
            if (!modal) {
                console.error('No import modal found');
                showNotification('No import modal found', 'error');
                return;
            }
            
            const importData = modal.importData;
            const name = document.getElementById('import-name').value.trim();
            const description = document.getElementById('import-description').value.trim();
            
            console.log('Importing study set:', { modal, importData, name, description });
            
            if (!importData) {
                console.error('No import data found');
                showNotification('No import data found', 'error');
                return;
            }
            
            if (!name) {
                console.error('No name provided');
                showNotification('Please enter a set name', 'error');
                return;
            }
            
            const newSet = {
                id: Date.now(),
                name: name,
                description: description,
                flashcards: importData.flashcards.map(card => ({
                    ...card,
                    id: Date.now() + Math.random(), // Generate new IDs
                    createdAt: new Date().toISOString(),
                    lastModified: new Date().toISOString()
                })),
                createdAt: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };
            
            console.log('Created new set:', newSet);
            
            studySets.push(newSet);
            console.log('Updated studySets:', studySets);
            
            saveStudySets();
            renderStudySets();
            modal.remove();
            
            // Clean URL
            window.history.replaceState({}, document.title, window.location.pathname);
            
            showNotification('Study set imported successfully!', 'success');
        }

        // Add import button to header
        function addImportButton() {
            const headerSection = document.querySelector('.bg-gradient-to-r.from-primary-500.to-secondary-500');
            if (!headerSection) return;
            
            const buttonContainer = headerSection.querySelector('.flex.items-center.gap-4');
            if (!buttonContainer) return;
            
            const importBtn = document.createElement('button');
            importBtn.className = 'inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-xl font-medium transition-all duration-200 backdrop-blur-sm';
            importBtn.innerHTML = '📥 Import';
            importBtn.onclick = () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                const data = JSON.parse(e.target.result);
                                showImportModal(data);
                            } catch (error) {
                                showNotification('Invalid file format', 'error');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            };
            buttonContainer.appendChild(importBtn);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Show loading state
            showLoadingState();
            
            // Simulate loading for better UX
            setTimeout(() => {
                loadStudySets();
                renderStudySets();
                checkForImport();
                addImportButton();
                hideLoadingState();
            }, 800);
        });

        // Loading state functions
        function showLoadingState() {
            const setsGrid = document.getElementById('sets-grid');
            if (setsGrid) {
                setsGrid.innerHTML = `
                    <div class="skeleton-card">
                        <div class="skeleton-header"></div>
                        <div class="skeleton-content"></div>
                        <div class="skeleton-content short"></div>
                        <div class="skeleton-actions"></div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-header"></div>
                        <div class="skeleton-content"></div>
                        <div class="skeleton-content short"></div>
                        <div class="skeleton-actions"></div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-header"></div>
                        <div class="skeleton-content"></div>
                        <div class="skeleton-content short"></div>
                        <div class="skeleton-actions"></div>
                    </div>
                `;
            }
        }

        function hideLoadingState() {
            // Loading state will be replaced by actual content
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
